<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Conditioned Latin Hypercube Sampling | Soil Sampling Design</title>
  <meta name="description" content="Chapter 5 Conditioned Latin Hypercube Sampling | Soil Sampling Design - SoilFer Project" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Conditioned Latin Hypercube Sampling | Soil Sampling Design" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/frontcover.png" />
  <meta property="og:description" content="Chapter 5 Conditioned Latin Hypercube Sampling | Soil Sampling Design - SoilFer Project" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Conditioned Latin Hypercube Sampling | Soil Sampling Design" />
  
  <meta name="twitter:description" content="Chapter 5 Conditioned Latin Hypercube Sampling | Soil Sampling Design - SoilFer Project" />
  <meta name="twitter:image" content="/images/frontcover.png" />

<meta name="author" content="Rodríguez Lado, L., Angelini, M.E, Naypewe, N., Luotto, I., Yigini, Y." />


<meta name="date" content="2023-12-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="stratified-sampling-design.html"/>
<link rel="next" href="references.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="assets/plotly-binding-4.10.0/plotly.js"></script>
<script src="assets/typedarray-0.1/typedarray.min.js"></script>
<link href="assets/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="assets/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="assets/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="assets/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="assets/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-1.3.1/leaflet.js"></script>
<link href="assets/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="assets/proj4-2.6.2/proj4.min.js"></script>
<script src="assets/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="assets/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="assets/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="assets/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<link href="assets/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="assets/HomeButton-0.0.1/home-button.js"></script>
<script src="assets/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="assets/clipboard-0.0.1/setClipboardText.js"></script>
<link href="assets/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="assets/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Soil Samping Design</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Licence</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#manual-structure"><i class="fa fa-check"></i><b>1.1</b> Manual Structure</a></li>
</ul></li>
<li class="part"><span><b>Part one - Soil Legacy Data</b></span></li>
<li class="chapter" data-level="2" data-path="legacy_data.html"><a href="legacy_data.html"><i class="fa fa-check"></i><b>2</b> Evaluating Soil Legacy Data Sampling for DSM</a>
<ul>
<li class="chapter" data-level="2.1" data-path="legacy_data.html"><a href="legacy_data.html#data-preparation"><i class="fa fa-check"></i><b>2.1</b> Data Preparation</a></li>
<li class="chapter" data-level="2.2" data-path="legacy_data.html"><a href="legacy_data.html#representativeness-of-the-legacy-soil-data"><i class="fa fa-check"></i><b>2.2</b> Representativeness of the Legacy Soil Data</a></li>
</ul></li>
<li class="part"><span><b>I Part two - Soil Sampling Design</b></span></li>
<li class="chapter" data-level="3" data-path="creating-a-sampling-design.html"><a href="creating-a-sampling-design.html"><i class="fa fa-check"></i><b>3</b> Creating a sampling design</a>
<ul>
<li class="chapter" data-level="3.1" data-path="creating-a-sampling-design.html"><a href="creating-a-sampling-design.html#determining-the-optimal-sample-size"><i class="fa fa-check"></i><b>3.1</b> Determining the optimal sample size</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="stratified-sampling-design.html"><a href="stratified-sampling-design.html"><i class="fa fa-check"></i><b>4</b> Stratified Sampling Design</a>
<ul>
<li class="chapter" data-level="4.1" data-path="stratified-sampling-design.html"><a href="stratified-sampling-design.html#general-procedure"><i class="fa fa-check"></i><b>4.1</b> General Procedure</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="stratified-sampling-design.html"><a href="stratified-sampling-design.html#strata-creation"><i class="fa fa-check"></i><b>4.1.1</b> Strata creation</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="stratified-sampling-design.html"><a href="stratified-sampling-design.html#stratified-random-sampling"><i class="fa fa-check"></i><b>4.2</b> Stratified random sampling</a></li>
<li class="chapter" data-level="4.3" data-path="stratified-sampling-design.html"><a href="stratified-sampling-design.html#stratified-random-sampling-for-large-areas"><i class="fa fa-check"></i><b>4.3</b> Stratified random sampling for large areas</a></li>
<li class="chapter" data-level="4.4" data-path="stratified-sampling-design.html"><a href="stratified-sampling-design.html#stratified-regular-sampling"><i class="fa fa-check"></i><b>4.4</b> Stratified regular sampling</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="conditioned-latin-hypercube-sampling.html"><a href="conditioned-latin-hypercube-sampling.html"><i class="fa fa-check"></i><b>5</b> Conditioned Latin Hypercube Sampling</a>
<ul>
<li class="chapter" data-level="5.1" data-path="conditioned-latin-hypercube-sampling.html"><a href="conditioned-latin-hypercube-sampling.html#clhs-design"><i class="fa fa-check"></i><b>5.1</b> cLHS design</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="conditioned-latin-hypercube-sampling.html"><a href="conditioned-latin-hypercube-sampling.html#general-procedure-1"><i class="fa fa-check"></i><b>5.1.1</b> General Procedure</a></li>
<li class="chapter" data-level="5.1.2" data-path="conditioned-latin-hypercube-sampling.html"><a href="conditioned-latin-hypercube-sampling.html#including-existing-legacy-data-in-a-chls-sampling-design"><i class="fa fa-check"></i><b>5.1.2</b> Including existing legacy data in a cHLS sampling design</a></li>
<li class="chapter" data-level="5.1.3" data-path="conditioned-latin-hypercube-sampling.html"><a href="conditioned-latin-hypercube-sampling.html#cost-constrained-implementation"><i class="fa fa-check"></i><b>5.1.3</b> Cost-constrained implementation</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="conditioned-latin-hypercube-sampling.html"><a href="conditioned-latin-hypercube-sampling.html#replacement-areas-in-clhs-design"><i class="fa fa-check"></i><b>5.2</b> Replacement areas in cLHS design</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://www.fao.org/global-soil-partnership/" target="blank">Global Soil Partnership</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Soil Sampling Design</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="conditioned-latin-hypercube-sampling" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Conditioned Latin Hypercube Sampling<a href="conditioned-latin-hypercube-sampling.html#conditioned-latin-hypercube-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Conditioned Latin Hypercube Sampling (cLHS) is an advanced statistical method used for sampling multidimensional data developed within the context of digital Soil Mapping. It’s an extension of the basic Latin Hypercube Sampling (LHS) technique, a statistical method for generating a distribution of samples of a random variable. The main advantage of LHS over simple random sampling is its ability to ensure that the entire range of the auxiliary variables are explored. It divides the range of each variable into intervals of equal probability and samples each interval.</p>
<p>The term “conditioned” refers to the way the sampling is adapted or conditioned based on specific requirements or constraints. It often involves conditioning the sampling process on one or more additional variables or criteria. This helps in generating samples that are not just representative in terms of the range of values, but also in terms of their relationships or distributions. cLHS is particularly useful for sampling from multivariate data, where there are multiple interrelated variables as it occurs in soil surveys. The main advantage of cLHS is its efficiency in sampling and its ability to better capture the structure and relationships within the data, compared to simpler sampling methods, and ensures that the samples are representative not just of the range of each variable, but also of their interrelations. Detailed information on cLHS can be found in <span class="citation">(<a href="#ref-minasny2006" role="doc-biblioref">Minasny and Mcbratney, 2006</a>)</span></p>
<div id="clhs-design" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> cLHS design<a href="conditioned-latin-hypercube-sampling.html#clhs-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="general-procedure-1" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> General Procedure<a href="conditioned-latin-hypercube-sampling.html#general-procedure-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As for stratified sampling, the creation target points from a conditioned Latin Hypercube Sampling design involves the identification of the relevant features describing the environmental diversity in the area. In this case, the environmental parameters are incorporated in the form of raster covariates. The determination of the optimal number of samples in the design is also required. This step can be calculated following the information already provided in this manual.</p>
<p>With the optimal sampling size of 98 calculated before, we can conduct conditioned Latin Hypercube Sampling design for the area in the example using the R package <code>'cLHS'</code> available at CRAN.</p>
<p>We use the rasters of ‘ECd’, ‘ECs’, ‘elevation’, ‘yield’ as covariates in the exercise, which we convert to a raster.</p>
<pre><code>## 
## Attaching package: &#39;raster&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:plotly&#39;:
## 
##     select</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<p>The target points are obtained using the <code>'cLHS'</code>function together with the stack of raster covariates and the number of samples. The function uses a number of iterations for the Metropolis-Hastings annealing process, with a default of 10000. We sample the covariate data set and pick a subset of points equal to the sample size determined previoulsly.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="conditioned-latin-hypercube-sampling.html#cb27-1" aria-hidden="true" tabindex="-1"></a>  pts <span class="ot">&lt;-</span> <span class="fu">clhs</span>(cov.dat, <span class="at">size =</span> optimal_n, <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">progress =</span> <span class="cn">FALSE</span>, <span class="at">simple =</span> <span class="cn">FALSE</span>)</span>
<span id="cb27-2"><a href="conditioned-latin-hypercube-sampling.html#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(pts, <span class="fu">c</span>(<span class="st">&#39;obj&#39;</span>))</span></code></pre></div>
<div class="figure">
<img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/fig-cLHS_design_05-1.png" alt="Evolution of the objective function" width="672" />
<p class="caption">
(#fig:fig-cLHS_design_05)Evolution of the objective function
</p>
</div>
<p>The distribution of points is shown in Figure <a href="conditioned-latin-hypercube-sampling.html#fig:fig-15">5.1</a>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="conditioned-latin-hypercube-sampling.html#cb28-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create a cLHS sampling point set----</span></span>
<span id="cb28-2"><a href="conditioned-latin-hypercube-sampling.html#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(cov.dat[[<span class="dv">1</span>]], <span class="at">main=</span><span class="st">&quot;cLHS samples&quot;</span>)</span>
<span id="cb28-3"><a href="conditioned-latin-hypercube-sampling.html#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(pts<span class="sc">$</span>sampled_data, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-15"></span>
<img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/fig-15-1.png" alt="Distribution of cLHS sampling points in the study area" width="672" />
<p class="caption">
Figure 5.1: Distribution of cLHS sampling points in the study area
</p>
</div>
</div>
<div id="including-existing-legacy-data-in-a-chls-sampling-design" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Including existing legacy data in a cHLS sampling design<a href="conditioned-latin-hypercube-sampling.html#including-existing-legacy-data-in-a-chls-sampling-design" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In situations where there are legacy soil data samples available, it would be interesting to include them in the cLHS design to increase the diversity of covriates and avoid oversampling for some conditions. In this cases, the ancillary data can be included in the design as additional points to the clhs fuction.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="conditioned-latin-hypercube-sampling.html#cb29-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read Spatial data covariates as rasters with terra</span></span>
<span id="cb29-2"><a href="conditioned-latin-hypercube-sampling.html#cb29-2" aria-hidden="true" tabindex="-1"></a>  rasters <span class="ot">&lt;-</span> <span class="st">&quot;data/rasters&quot;</span></span>
<span id="cb29-3"><a href="conditioned-latin-hypercube-sampling.html#cb29-3" aria-hidden="true" tabindex="-1"></a>  cov.dat <span class="ot">&lt;-</span>  <span class="fu">list.files</span>(rasters, <span class="at">pattern =</span> <span class="st">&quot;tif$&quot;</span>,  <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-4"><a href="conditioned-latin-hypercube-sampling.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  cov.dat <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(cov.dat)</span>
<span id="cb29-5"><a href="conditioned-latin-hypercube-sampling.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We create an artificial legacy dataset of 20 samples over the study area</span></span>
<span id="cb29-6"><a href="conditioned-latin-hypercube-sampling.html#cb29-6" aria-hidden="true" tabindex="-1"></a>  legacy.data <span class="ot">&lt;-</span> <span class="fu">spatSample</span>(cov.dat,<span class="dv">10</span>, <span class="at">na.rm=</span><span class="cn">TRUE</span>,<span class="at">xy=</span><span class="cn">TRUE</span>,<span class="at">method=</span><span class="st">&quot;random&quot;</span>)</span>
<span id="cb29-7"><a href="conditioned-latin-hypercube-sampling.html#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get covariates data as a dataframe with coordinates</span></span>
<span id="cb29-8"><a href="conditioned-latin-hypercube-sampling.html#cb29-8" aria-hidden="true" tabindex="-1"></a>  cov.df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">crds</span>(cov.dat),<span class="fu">as.data.frame</span>(cov.dat))</span>
<span id="cb29-9"><a href="conditioned-latin-hypercube-sampling.html#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Delete data from pixels outside the study area</span></span>
<span id="cb29-10"><a href="conditioned-latin-hypercube-sampling.html#cb29-10" aria-hidden="true" tabindex="-1"></a>  cov.df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(cov.df)</span>
<span id="cb29-11"><a href="conditioned-latin-hypercube-sampling.html#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge legacy and covariate information</span></span>
<span id="cb29-12"><a href="conditioned-latin-hypercube-sampling.html#cb29-12" aria-hidden="true" tabindex="-1"></a>  leg.new <span class="ot">&lt;-</span>   <span class="fu">rbind</span>(legacy.data, cov.df)</span>
<span id="cb29-13"><a href="conditioned-latin-hypercube-sampling.html#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate clhs points with legacy data</span></span>
<span id="cb29-14"><a href="conditioned-latin-hypercube-sampling.html#cb29-14" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">clhs</span>(<span class="at">x =</span> leg.new, <span class="at">size =</span> <span class="dv">30</span>,  <span class="at">iter =</span> <span class="dv">5000</span>,<span class="at">simple =</span> <span class="cn">FALSE</span>, <span class="at">progress =</span> <span class="cn">FALSE</span>,</span>
<span id="cb29-15"><a href="conditioned-latin-hypercube-sampling.html#cb29-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">must.include =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(legacy.data)))</span>
<span id="cb29-16"><a href="conditioned-latin-hypercube-sampling.html#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot objective function</span></span>
<span id="cb29-17"><a href="conditioned-latin-hypercube-sampling.html#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(res)</span></code></pre></div>
<p><img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/clhs-legacy-05-1.png" width="672" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="conditioned-latin-hypercube-sampling.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get sampling points</span></span>
<span id="cb30-2"><a href="conditioned-latin-hypercube-sampling.html#cb30-2" aria-hidden="true" tabindex="-1"></a>  points <span class="ot">&lt;-</span> res<span class="sc">$</span>sampled_data</span></code></pre></div>
<p>Figure <a href="conditioned-latin-hypercube-sampling.html#fig:fig-16">5.2</a> shows the distribution of new samples along with legacy data points.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="conditioned-latin-hypercube-sampling.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot points</span></span>
<span id="cb31-2"><a href="conditioned-latin-hypercube-sampling.html#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(cov.dat[[<span class="dv">1</span>]], <span class="at">main=</span><span class="st">&quot;Samples (point) and legacy samples (cross)&quot;</span>)</span>
<span id="cb31-3"><a href="conditioned-latin-hypercube-sampling.html#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(points, <span class="at">col=</span><span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb31-4"><a href="conditioned-latin-hypercube-sampling.html#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(legacy.data, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-16"></span>
<img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/fig-16-1.png" alt="cLHS sampling points with legacy data" width="672" />
<p class="caption">
Figure 5.2: cLHS sampling points with legacy data
</p>
</div>
</div>
<div id="cost-constrained-implementation" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Cost-constrained implementation<a href="conditioned-latin-hypercube-sampling.html#cost-constrained-implementation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>CLHS can also be implemented taking into account environmental features such as terrain (elevation, slope) or accessibility (distance to roads) that can alter the sampling process. This is done by defining constraints as ‘cost’ layers in the options of the <code>'clhs'</code> function.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="conditioned-latin-hypercube-sampling.html#cb32-1" aria-hidden="true" tabindex="-1"></a>  cov.dat <span class="ot">&lt;-</span> raster<span class="sc">::</span><span class="fu">stack</span>(cov.dat)</span>
<span id="cb32-2"><a href="conditioned-latin-hypercube-sampling.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create a cLHS sampling point set----</span></span>
<span id="cb32-3"><a href="conditioned-latin-hypercube-sampling.html#cb32-3" aria-hidden="true" tabindex="-1"></a>  pts <span class="ot">&lt;-</span> <span class="fu">clhs</span>(cov.dat, <span class="at">size =</span> optimal_n, <span class="at">iter =</span> <span class="dv">5000</span>, <span class="at">progress =</span> <span class="cn">FALSE</span>, <span class="at">simple =</span> <span class="cn">FALSE</span>, <span class="at">cost =</span> <span class="st">&#39;elevation&#39;</span>,  <span class="at">use.cpp =</span> F)</span>
<span id="cb32-4"><a href="conditioned-latin-hypercube-sampling.html#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(pts, <span class="fu">c</span>(<span class="st">&#39;obj&#39;</span>, <span class="st">&#39;cost&#39;</span>))</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-18"></span>
<img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/fig-18-1.png" alt="cLHS sampling with cost layers" width="672" />
<p class="caption">
Figure 5.3: cLHS sampling with cost layers
</p>
</div>
</div>
</div>
<div id="replacement-areas-in-clhs-design" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Replacement areas in cLHS design<a href="conditioned-latin-hypercube-sampling.html#replacement-areas-in-clhs-design" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>'cLHS'</code> package incorporates methods for the delineation of replacement locations that could be utilized in the case any sampling point is unreachable. In this case, the function determines the probability of similarity to each point in an area determined by a buffer distance around the points.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="conditioned-latin-hypercube-sampling.html#cb33-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Determine the similarity to points in a buffer of distance D</span></span>
<span id="cb33-2"><a href="conditioned-latin-hypercube-sampling.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Note that distance units are expressed in map units, in this case meters</span></span>
<span id="cb33-3"><a href="conditioned-latin-hypercube-sampling.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If your data is in geographic coordinates, D must be included in geographic units as well</span></span>
<span id="cb33-4"><a href="conditioned-latin-hypercube-sampling.html#cb33-4" aria-hidden="true" tabindex="-1"></a>    D <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb33-5"><a href="conditioned-latin-hypercube-sampling.html#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="conditioned-latin-hypercube-sampling.html#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Compute the buffers around points  </span></span>
<span id="cb33-7"><a href="conditioned-latin-hypercube-sampling.html#cb33-7" aria-hidden="true" tabindex="-1"></a>    gw <span class="ot">&lt;-</span> <span class="fu">similarity_buffer</span>(cov.dat, pts<span class="sc">$</span>sampled_data, <span class="at">buffer =</span> D)</span>
<span id="cb33-8"><a href="conditioned-latin-hypercube-sampling.html#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Plot the first buffers in the stack</span></span>
<span id="cb33-9"><a href="conditioned-latin-hypercube-sampling.html#cb33-9" aria-hidden="true" tabindex="-1"></a>      <span class="co">#plot(gw)</span></span>
<span id="cb33-10"><a href="conditioned-latin-hypercube-sampling.html#cb33-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-11"><a href="conditioned-latin-hypercube-sampling.html#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Overlay point location to buffer plots</span></span>
<span id="cb33-12"><a href="conditioned-latin-hypercube-sampling.html#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># fun &lt;- function() {</span></span>
<span id="cb33-13"><a href="conditioned-latin-hypercube-sampling.html#cb33-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#   plot(pts$sampled_data, add = TRUE, col = &quot;red&quot;, pch = 3)</span></span>
<span id="cb33-14"><a href="conditioned-latin-hypercube-sampling.html#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># }</span></span>
<span id="cb33-15"><a href="conditioned-latin-hypercube-sampling.html#cb33-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot(gw, addfun = fun)</span></span></code></pre></div>
<p>The similarity probabilities for the first cLHS point is presented on Figure <a href="conditioned-latin-hypercube-sampling.html#fig:fig-19">5.4</a> over the elevation layer.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="conditioned-latin-hypercube-sampling.html#cb34-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Plot elevation</span></span>
<span id="cb34-2"><a href="conditioned-latin-hypercube-sampling.html#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(cov.dat[[<span class="dv">3</span>]], <span class="at">legend=</span><span class="cn">TRUE</span>,<span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;Similarity Probability over elevation&quot;</span>))</span>
<span id="cb34-3"><a href="conditioned-latin-hypercube-sampling.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Overlay points</span></span>
<span id="cb34-4"><a href="conditioned-latin-hypercube-sampling.html#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(pts<span class="sc">$</span>sampled_data[<span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;dodgerblue&quot;</span>, <span class="at">pch =</span> <span class="dv">3</span>)</span>
<span id="cb34-5"><a href="conditioned-latin-hypercube-sampling.html#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Overlay probability stack for point 1</span></span>
<span id="cb34-6"><a href="conditioned-latin-hypercube-sampling.html#cb34-6" aria-hidden="true" tabindex="-1"></a>    colors <span class="ot">&lt;-</span> <span class="fu">c</span>((RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;YlOrRd&quot;</span>)))</span>
<span id="cb34-7"><a href="conditioned-latin-hypercube-sampling.html#cb34-7" aria-hidden="true" tabindex="-1"></a>    terra<span class="sc">::</span><span class="fu">plot</span>(gw[[<span class="dv">1</span>]], <span class="at">add=</span><span class="cn">TRUE</span> ,  <span class="at">legend=</span><span class="cn">FALSE</span>, <span class="at">col=</span>colors)</span>
<span id="cb34-8"><a href="conditioned-latin-hypercube-sampling.html#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Overlay 1st cLHS point</span></span>
<span id="cb34-9"><a href="conditioned-latin-hypercube-sampling.html#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(pts<span class="sc">$</span>sampled_data[<span class="dv">1</span>,<span class="dv">1</span>], <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">pch =</span> <span class="dv">3</span>,<span class="at">cex=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-19"></span>
<img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/fig-19-1.png" alt="Probability of similarity in the buffer for the first cLHS point (in black) over elevation. The blue crosses represent the location of the remaining cLHS points from the analysis." width="672" />
<p class="caption">
Figure 5.4: Probability of similarity in the buffer for the first cLHS point (in black) over elevation. The blue crosses represent the location of the remaining cLHS points from the analysis.
</p>
</div>
<p>The probabilities can then be reclassified using a threshold value to delineate the areas with higher similarity to each central target point.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="conditioned-latin-hypercube-sampling.html#cb35-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Determine the threshold break to determine if the surrounding area can be a replacement or not</span></span>
<span id="cb35-2"><a href="conditioned-latin-hypercube-sampling.html#cb35-2" aria-hidden="true" tabindex="-1"></a>    similarity_threshold <span class="ot">&lt;-</span> <span class="fl">0.90</span></span>
<span id="cb35-3"><a href="conditioned-latin-hypercube-sampling.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Reclassify buffer raster data according to the threshold break of probability</span></span>
<span id="cb35-4"><a href="conditioned-latin-hypercube-sampling.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1 = similarity &gt;= similarity_break; NA =  similarity &lt;  similarity_break</span></span>
<span id="cb35-5"><a href="conditioned-latin-hypercube-sampling.html#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define a vector with the break intervals and the output values (NA,1) </span></span>
<span id="cb35-6"><a href="conditioned-latin-hypercube-sampling.html#cb35-6" aria-hidden="true" tabindex="-1"></a>    breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, similarity_threshold, <span class="cn">NA</span>, similarity_threshold, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb35-7"><a href="conditioned-latin-hypercube-sampling.html#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert to a matrix</span></span>
<span id="cb35-8"><a href="conditioned-latin-hypercube-sampling.html#cb35-8" aria-hidden="true" tabindex="-1"></a>    breaks <span class="ot">&lt;-</span> <span class="fu">matrix</span>(breaks, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb35-9"><a href="conditioned-latin-hypercube-sampling.html#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reclassify the data in the layers from probabilities to (NA,)</span></span>
<span id="cb35-10"><a href="conditioned-latin-hypercube-sampling.html#cb35-10" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">=</span> <span class="fu">stack</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>raster<span class="sc">::</span><span class="fu">nlayers</span>(gw), <span class="cf">function</span>(i){<span class="fu">reclassify</span>(gw[[i]], breaks, <span class="at">right=</span><span class="cn">FALSE</span>)}))</span>
<span id="cb35-11"><a href="conditioned-latin-hypercube-sampling.html#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#s</span></span>
<span id="cb35-12"><a href="conditioned-latin-hypercube-sampling.html#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot points over reclassified rasters </span></span>
<span id="cb35-13"><a href="conditioned-latin-hypercube-sampling.html#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plot(s, addfun = fun)</span></span>
<span id="cb35-14"><a href="conditioned-latin-hypercube-sampling.html#cb35-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb35-15"><a href="conditioned-latin-hypercube-sampling.html#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Remove temporary objects</span></span>
<span id="cb35-16"><a href="conditioned-latin-hypercube-sampling.html#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span>(gw,breaks)</span></code></pre></div>
<p>The reclassified raster stack is then converted to an object of <code>'SpatialPolygonsDataFrame'</code> class.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="conditioned-latin-hypercube-sampling.html#cb36-1" aria-hidden="true" tabindex="-1"></a>   <span class="do">## Polygonize replacement areas </span></span>
<span id="cb36-2"><a href="conditioned-latin-hypercube-sampling.html#cb36-2" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">=</span> <span class="fu">lapply</span>(<span class="fu">as.list</span>(s), rasterToPolygons, <span class="at">dissolve=</span><span class="cn">TRUE</span>)</span>
<span id="cb36-3"><a href="conditioned-latin-hypercube-sampling.html#cb36-3" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">bind</span>(s,<span class="at">keepnames=</span><span class="cn">TRUE</span>)</span>
<span id="cb36-4"><a href="conditioned-latin-hypercube-sampling.html#cb36-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-5"><a href="conditioned-latin-hypercube-sampling.html#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the identifier of the corresponding target point</span></span>
<span id="cb36-6"><a href="conditioned-latin-hypercube-sampling.html#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span> <span class="fu">length</span>(s)){</span>
<span id="cb36-7"><a href="conditioned-latin-hypercube-sampling.html#cb36-7" aria-hidden="true" tabindex="-1"></a>      s<span class="sc">@</span>data<span class="sc">$</span>ID[i] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(stringr<span class="sc">::</span><span class="fu">str_replace</span>(s<span class="sc">@</span>polygons[[i]]<span class="sc">@</span>ID,<span class="st">&quot;1.&quot;</span>,<span class="st">&quot;&quot;</span>))</span>
<span id="cb36-8"><a href="conditioned-latin-hypercube-sampling.html#cb36-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb36-9"><a href="conditioned-latin-hypercube-sampling.html#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Clean the data by storing target ID data only</span></span>
<span id="cb36-10"><a href="conditioned-latin-hypercube-sampling.html#cb36-10" aria-hidden="true" tabindex="-1"></a>    s<span class="sc">@</span>data <span class="ot">&lt;-</span> s<span class="sc">@</span>data[<span class="st">&quot;ID&quot;</span>]</span></code></pre></div>
<p>The results are shown in Figure <a href="conditioned-latin-hypercube-sampling.html#fig:fig-20">5.5</a>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="conditioned-latin-hypercube-sampling.html#cb37-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(cov.dat[[<span class="dv">1</span>]], <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;cLHS samples and replacement areas for threshold = &quot;</span>, similarity_threshold))</span>
<span id="cb37-2"><a href="conditioned-latin-hypercube-sampling.html#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(s,<span class="at">add=</span><span class="cn">TRUE</span>, <span class="at">col=</span><span class="cn">NA</span>, <span class="at">border=</span><span class="st">&quot;gray40&quot;</span>)</span>
<span id="cb37-3"><a href="conditioned-latin-hypercube-sampling.html#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(pts<span class="sc">$</span>sampled_data, <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-20"></span>
<img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/fig-20-1.png" alt="Distribution of cLHS sampling points in the study area" width="672" />
<p class="caption">
Figure 5.5: Distribution of cLHS sampling points in the study area
</p>
</div>
<p>The layer of replacement areas can finally be exported to a ‘shapefile’ to be used in any other software.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="conditioned-latin-hypercube-sampling.html#cb38-1" aria-hidden="true" tabindex="-1"></a>   <span class="do">## Write replacement areas to polygon shape </span></span>
<span id="cb38-2"><a href="conditioned-latin-hypercube-sampling.html#cb38-2" aria-hidden="true" tabindex="-1"></a>    s <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(s)</span>
<span id="cb38-3"><a href="conditioned-latin-hypercube-sampling.html#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_write</span>(s, <span class="fu">paste0</span>(<span class="st">&#39;replacement_areas_&#39;</span>, D, <span class="st">&#39;.shp&#39;</span>), <span class="at">delete_dsn =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-4"><a href="conditioned-latin-hypercube-sampling.html#cb38-4" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb38-5"><a href="conditioned-latin-hypercube-sampling.html#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Write  cLHS sampling points to shapefile</span></span>
<span id="cb38-6"><a href="conditioned-latin-hypercube-sampling.html#cb38-6" aria-hidden="true" tabindex="-1"></a>    pts <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(pts<span class="sc">$</span>sampled_data)</span>
<span id="cb38-7"><a href="conditioned-latin-hypercube-sampling.html#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_write</span>(pts, <span class="st">&#39;target_clhs.shp&#39;</span>, <span class="at">delete_dsn =</span> <span class="cn">TRUE</span>)</span></code></pre></div>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-minasny2006" class="csl-entry">
<strong>Minasny, B. &amp; Mcbratney, A.</strong> 2006. A conditioned latin hypercube method for sampling in the presence of ancillary information. <em>Computers &amp; Geosciences</em>, 32: 1378–1388. <a href="https://doi.org/10.1016/j.cageo.2005.12.009">https://doi.org/10.1016/j.cageo.2005.12.009</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="stratified-sampling-design.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/luislado/Sampling_Design_GSP/edit/master/05-clhs_sampling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Technical Manual Soil Sampling Design.pdf", "Technical Manual Soil Sampling Design.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"toolbar": {
"position": "static"
}
});
});
</script>

</body>

</html>
