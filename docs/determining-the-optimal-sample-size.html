<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.1 Determining the optimal sample size |  Soil Sampling Design</title>
  <meta name="description" content="Technical Manual on Soil Sampling Design - SoilFer Project" />
  <meta name="generator" content="bookdown 0.36 and GitBook 2.6.7" />

  <meta property="og:title" content="3.1 Determining the optimal sample size |  Soil Sampling Design" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Technical Manual on Soil Sampling Design - SoilFer Project" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.1 Determining the optimal sample size |  Soil Sampling Design" />
  
  <meta name="twitter:description" content="Technical Manual on Soil Sampling Design - SoilFer Project" />
  

<meta name="author" content="Rodríguez Lado, L., Angelini, M.E, Naypewe, N., Luotto, I., Yigini, Y." />


<meta name="date" content="2023-12-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="creating-a-sampling-design.html"/>
<link rel="next" href="stratified-sampling-design.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="assets/plotly-binding-4.10.0/plotly.js"></script>
<script src="assets/typedarray-0.1/typedarray.min.js"></script>
<link href="assets/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="assets/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="assets/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="assets/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="assets/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-1.3.1/leaflet.js"></script>
<link href="assets/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="assets/proj4-2.6.2/proj4.min.js"></script>
<script src="assets/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="assets/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="assets/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="assets/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<link href="assets/HomeButton-0.0.1/home-button.css" rel="stylesheet" />
<script src="assets/HomeButton-0.0.1/home-button.js"></script>
<script src="assets/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="assets/clipboard-0.0.1/setClipboardText.js"></script>
<link href="assets/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="assets/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Licence</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="manual-structure.html"><a href="manual-structure.html"><i class="fa fa-check"></i><b>1.1</b> Manual Structure</a></li>
<li class="chapter" data-level="" data-path="conditioned-latin-hypercube-sampling-clhs.html"><a href="conditioned-latin-hypercube-sampling-clhs.html"><i class="fa fa-check"></i>Conditioned Latin Hypercube Sampling (cLHS)</a></li>
</ul></li>
<li class="part"><span><b>Part one - Soil Legacy Data</b></span></li>
<li class="chapter" data-level="2" data-path="legacy_data.html"><a href="legacy_data.html"><i class="fa fa-check"></i><b>2</b> Evaluating Soil Legacy Data Sampling for DSM</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-preparation.html"><a href="data-preparation.html"><i class="fa fa-check"></i><b>2.1</b> Data Preparation</a></li>
<li class="chapter" data-level="2.2" data-path="representativeness-of-the-legacy-soil-data.html"><a href="representativeness-of-the-legacy-soil-data.html"><i class="fa fa-check"></i><b>2.2</b> Representativeness of the Legacy Soil Data</a></li>
</ul></li>
<li class="part"><span><b>I Part two - Soil Sampling Design</b></span></li>
<li class="chapter" data-level="3" data-path="creating-a-sampling-design.html"><a href="creating-a-sampling-design.html"><i class="fa fa-check"></i><b>3</b> Creating a sampling design</a>
<ul>
<li class="chapter" data-level="3.1" data-path="determining-the-optimal-sample-size.html"><a href="determining-the-optimal-sample-size.html"><i class="fa fa-check"></i><b>3.1</b> Determining the optimal sample size</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="stratified-sampling-design.html"><a href="stratified-sampling-design.html"><i class="fa fa-check"></i><b>4</b> Stratified Sampling Design</a>
<ul>
<li class="chapter" data-level="4.1" data-path="general-procedure.html"><a href="general-procedure.html"><i class="fa fa-check"></i><b>4.1</b> General Procedure</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="general-procedure.html"><a href="general-procedure.html#strata-creation"><i class="fa fa-check"></i><b>4.1.1</b> Strata creation</a></li>
<li class="chapter" data-level="4.1.2" data-path="general-procedure.html"><a href="general-procedure.html#stratified-random-sampling"><i class="fa fa-check"></i><b>4.1.2</b> Stratified random sampling</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="stratified-random-sampling-for-large-areas.html"><a href="stratified-random-sampling-for-large-areas.html"><i class="fa fa-check"></i><b>4.2</b> Stratified random sampling for large areas</a></li>
<li class="chapter" data-level="4.3" data-path="stratified-regular-sampling.html"><a href="stratified-regular-sampling.html"><i class="fa fa-check"></i><b>4.3</b> Stratified regular sampling</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p><img src="images/frontcover.png" style="top:0px;height:300px;" align="right" />
Soil Sampling Design</p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="determining-the-optimal-sample-size" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Determining the optimal sample size<a href="determining-the-optimal-sample-size.html#determining-the-optimal-sample-size" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Several strategies exist for designing soil sampling, including regular, random, and stratified sampling. Each strategy comes with its own set of advantages and limitations, which must be carefully considered before commencing a soil sampling campaign. Regular sampling, also called grid sampling, is straightforward and ensures uniform coverage, making it suitable for spatial analysis and detecting trends. However, it may introduce bias and miss small-scale variability. Generally, random sampling may require a larger number of samples to accurately capture soil variability compared to stratified sampling, which is more targeted. Nonetheless, from a statistical standpoint, random sampling is often preferred. It effectively minimizes selection bias by giving every part of the study area an equal chance of being selected. This approach yields a sample that is truly representative of the entire population, leading to more accurate, broadly applicable conclusions. Random sampling also supports valid statistical inferences, ensures reliability of results, and simplifies the estimation of errors, thereby facilitating a broad spectrum of statistical analyses.</p>
<p>The determination of both the number and locations of soil samples is an important element in the success of any sampling campaign. The chosen strategy directly influences the representativeness and accuracy of the soil data collected, which in turn impacts the quality of the conclusions drawn from the study.</p>
<p>In this exercise, we make use of the data provided by <span class="citation">(<a href="#ref-Malone" role="doc-biblioref">Malone, Minansy and Brungard, 2019</a>)</span> with 4 raster covariates in a 100 has area. We want to determine the minimal number of soil samples that must be collated to capture at least the 95% of variability within the environmental covariates. The procedure start with random distribution of a low number of samples in the area, determine the values of the spatial covariates, and compare them with those representing the whole diversity in the area at pixel scale. The comparisons are made using the <code>'KL divergence'</code> and the <code>'% of representativeness'</code> - i.e. the variability of covariate information in the complete area related to the variability of covariate information in the dataset of samples. Further information can be found in the original work of <span class="citation">(<a href="#ref-Malone" role="doc-biblioref">Malone, Minansy and Brungard, 2019</a>)</span>.</p>
<p>The initial section of the script is related to setup options in the methodology. We load of R packages, define the working directory, load covariate data and store it as <code>SpatRaster</code> object. Here, parameter related to further aspects of the analyses such as the initial and final number of samples, and the increment step are defined.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="determining-the-optimal-sample-size.html#cb13-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Load raster covariate data----</span></span>
<span id="cb13-2"><a href="determining-the-optimal-sample-size.html#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read Spatial data covariates as rasters with terra</span></span>
<span id="cb13-3"><a href="determining-the-optimal-sample-size.html#cb13-3" aria-hidden="true" tabindex="-1"></a>  rasters <span class="ot">&lt;-</span> <span class="st">&quot;data/rasters&quot;</span></span>
<span id="cb13-4"><a href="determining-the-optimal-sample-size.html#cb13-4" aria-hidden="true" tabindex="-1"></a>  cov.dat <span class="ot">&lt;-</span>  <span class="fu">list.files</span>(rasters, <span class="at">pattern =</span> <span class="st">&quot;tif$&quot;</span>,  <span class="at">recursive =</span> <span class="cn">TRUE</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-5"><a href="determining-the-optimal-sample-size.html#cb13-5" aria-hidden="true" tabindex="-1"></a>  cov.dat <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(cov.dat)</span></code></pre></div>
<p>We can see the covariates in a plot.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="determining-the-optimal-sample-size.html#cb14-1" aria-hidden="true" tabindex="-1"></a>   <span class="fu">plot</span>(cov.dat)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-5"></span>
<img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/fig-5-1.png" alt="Plot of the covariates" width="672" />
<p class="caption">
Figure 3.1: Plot of the covariates
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="determining-the-optimal-sample-size.html#cb15-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Define the number of samples to be tested in a loop (from initial to final) and the step of the sequence</span></span>
<span id="cb15-2"><a href="determining-the-optimal-sample-size.html#cb15-2" aria-hidden="true" tabindex="-1"></a>  initial.n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb15-3"><a href="determining-the-optimal-sample-size.html#cb15-3" aria-hidden="true" tabindex="-1"></a>  final.n <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb15-4"><a href="determining-the-optimal-sample-size.html#cb15-4" aria-hidden="true" tabindex="-1"></a>  by.n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb15-5"><a href="determining-the-optimal-sample-size.html#cb15-5" aria-hidden="true" tabindex="-1"></a>  iters <span class="ot">&lt;-</span> <span class="dv">10</span></span></code></pre></div>
<p>The second section is where the analyses of divergence and representativeness of the sampling scheme are calculated.</p>
<p>The analyses are performed in a loop using growing numbers of samples at each trial. Some empty vectors are defined to store the output results at each loop. At each trial of sample size <code>'N'</code>, soil samples are located randomly on the space of covariates, and 10 replicates are calculated to determine the amount inter variability in KL divergence and representativeness in the trial. The final results for each sample size correspond to the mean results obtained from each iteration at the corresponding sample size. The optimal sample size selected correspond to the minimum sample size that accounts for at least 95% of the variability of information in the covariates within the area. The optimal sampling schema proposed correspond to the random scheme at the optimal sample size with higher value of representativeness.</p>
<p>Figure @ref(fig:chunk-compute_n_optimal_03) shows the distribution of covariates in the sample space.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="determining-the-optimal-sample-size.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the polygon and all points to be checked</span></span>
<span id="cb16-2"><a href="determining-the-optimal-sample-size.html#cb16-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">plot</span>(newScores[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">xlab=</span><span class="st">&quot;PCA 1&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;PCA 2&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="fu">min</span>(newScores[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]), <span class="fu">max</span>(newScores[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])), <span class="at">ylim=</span><span class="fu">c</span>(<span class="fu">min</span>(newScores[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]), <span class="fu">max</span>(newScores[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])),</span>
<span id="cb16-3"><a href="determining-the-optimal-sample-size.html#cb16-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">col=</span><span class="st">&#39;black&#39;</span>, <span class="at">main=</span><span class="st">&#39;Environmental space plots over the convex hull of soil legacy data&#39;</span>)</span>
<span id="cb16-4"><a href="determining-the-optimal-sample-size.html#cb16-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">polygon</span>(pr_poly,<span class="at">col=</span><span class="st">&#39;#99999990&#39;</span>)</span>
<span id="cb16-5"><a href="determining-the-optimal-sample-size.html#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># # Plot points outside convex hull  </span></span>
<span id="cb16-6"><a href="determining-the-optimal-sample-size.html#cb16-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">points</span>(newScores[<span class="fu">which</span>(newScores<span class="sc">$</span>pip<span class="sc">==</span><span class="dv">0</span>),<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">col=</span><span class="st">&#39;red&#39;</span>, <span class="at">pch=</span><span class="dv">12</span>, <span class="at">cex =</span><span class="dv">1</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-7"></span>
<img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/fig-7-1.png" alt="Distribution of covariates in the sample space" width="672" />
<p class="caption">
Figure 3.2: Distribution of covariates in the sample space
</p>
</div>
<p>We determine the optimal sample size and plot the evaluation results.</p>
<p>The following figure shows the evolution of the KL divergence and % of repressentativenes with growing sample sizes. The red dot identifies the trial with the optimal sample size for the area in relation to the covariates analysed.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="determining-the-optimal-sample-size.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PLot cdf and optimal sampling point</span></span>
<span id="cb17-2"><a href="determining-the-optimal-sample-size.html#cb17-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> xx</span>
<span id="cb17-3"><a href="determining-the-optimal-sample-size.html#cb17-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> normalized</span>
<span id="cb17-4"><a href="determining-the-optimal-sample-size.html#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="determining-the-optimal-sample-size.html#cb17-5" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x,y)</span>
<span id="cb17-6"><a href="determining-the-optimal-sample-size.html#cb17-6" aria-hidden="true" tabindex="-1"></a>opti <span class="ot">&lt;-</span> mydata[mydata<span class="sc">$</span>x<span class="sc">==</span>optimal_n,]</span>
<span id="cb17-7"><a href="determining-the-optimal-sample-size.html#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="determining-the-optimal-sample-size.html#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(mydata,</span>
<span id="cb17-9"><a href="determining-the-optimal-sample-size.html#cb17-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="sc">~</span><span class="fu">seq</span>(initial.n, final.n,by.n),</span>
<span id="cb17-10"><a href="determining-the-optimal-sample-size.html#cb17-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="sc">~</span><span class="fu">fitted</span>(fit1),</span>
<span id="cb17-11"><a href="determining-the-optimal-sample-size.html#cb17-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">mode =</span> <span class="st">&quot;lines+markers&quot;</span>,</span>
<span id="cb17-12"><a href="determining-the-optimal-sample-size.html#cb17-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">type =</span> <span class="st">&quot;scatter&quot;</span>,</span>
<span id="cb17-13"><a href="determining-the-optimal-sample-size.html#cb17-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">&quot;KL divergence&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-14"><a href="determining-the-optimal-sample-size.html#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x,</span>
<span id="cb17-15"><a href="determining-the-optimal-sample-size.html#cb17-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="sc">~</span>y,</span>
<span id="cb17-16"><a href="determining-the-optimal-sample-size.html#cb17-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">mode =</span> <span class="st">&quot;lines+markers&quot;</span>,</span>
<span id="cb17-17"><a href="determining-the-optimal-sample-size.html#cb17-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&quot;scatter&quot;</span>,</span>
<span id="cb17-18"><a href="determining-the-optimal-sample-size.html#cb17-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">yaxis =</span> <span class="st">&quot;y2&quot;</span>,</span>
<span id="cb17-19"><a href="determining-the-optimal-sample-size.html#cb17-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">name =</span> <span class="st">&quot;Fitted representativeness&quot;</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb17-20"><a href="determining-the-optimal-sample-size.html#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>opti<span class="sc">$</span>x,</span>
<span id="cb17-21"><a href="determining-the-optimal-sample-size.html#cb17-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">y =</span> <span class="sc">~</span>opti<span class="sc">$</span>y,</span>
<span id="cb17-22"><a href="determining-the-optimal-sample-size.html#cb17-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">yaxis =</span> <span class="st">&quot;y2&quot;</span>,</span>
<span id="cb17-23"><a href="determining-the-optimal-sample-size.html#cb17-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">mode =</span> <span class="st">&quot;markers&quot;</span>,</span>
<span id="cb17-24"><a href="determining-the-optimal-sample-size.html#cb17-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">name =</span> <span class="st">&quot;Optimal N&quot;</span>,</span>
<span id="cb17-25"><a href="determining-the-optimal-sample-size.html#cb17-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">&#39;#d62728&#39;</span>,<span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">width =</span> <span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb17-26"><a href="determining-the-optimal-sample-size.html#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;N&quot;</span>, </span>
<span id="cb17-27"><a href="determining-the-optimal-sample-size.html#cb17-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">showgrid =</span> T, </span>
<span id="cb17-28"><a href="determining-the-optimal-sample-size.html#cb17-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">dtick =</span> <span class="dv">50</span>, </span>
<span id="cb17-29"><a href="determining-the-optimal-sample-size.html#cb17-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tickfont =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">11</span>)),</span>
<span id="cb17-30"><a href="determining-the-optimal-sample-size.html#cb17-30" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;mean KL divergence&quot;</span>, <span class="at">showgrid =</span> F ),</span>
<span id="cb17-31"><a href="determining-the-optimal-sample-size.html#cb17-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">yaxis2 =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">&quot;Representativeness (%)&quot;</span>,</span>
<span id="cb17-32"><a href="determining-the-optimal-sample-size.html#cb17-32" aria-hidden="true" tabindex="-1"></a>                       <span class="at">overlaying =</span> <span class="st">&quot;y&quot;</span>, <span class="at">side =</span> <span class="st">&quot;right&quot;</span>),</span>
<span id="cb17-33"><a href="determining-the-optimal-sample-size.html#cb17-33" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">list</span>(<span class="at">orientation =</span> <span class="st">&quot;h&quot;</span>, <span class="at">y =</span> <span class="fl">1.2</span>, <span class="at">x =</span> <span class="fl">0.1</span>,</span>
<span id="cb17-34"><a href="determining-the-optimal-sample-size.html#cb17-34" aria-hidden="true" tabindex="-1"></a>                       <span class="at">traceorder =</span> <span class="st">&quot;normal&quot;</span>),</span>
<span id="cb17-35"><a href="determining-the-optimal-sample-size.html#cb17-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">margin =</span> <span class="fu">list</span>(<span class="at">t =</span> <span class="dv">50</span>, <span class="at">b =</span> <span class="dv">50</span>, <span class="at">r =</span> <span class="dv">100</span>, <span class="at">l =</span> <span class="dv">80</span>),</span>
<span id="cb17-36"><a href="determining-the-optimal-sample-size.html#cb17-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">hovermode =</span> <span class="st">&#39;x&#39;</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb17-37"><a href="determining-the-optimal-sample-size.html#cb17-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">config</span>(<span class="at">displayModeBar =</span> <span class="cn">FALSE</span>) </span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-8"></span>
<div id="htmlwidget-d6c01a2041322b21bff5" style="width:768px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d6c01a2041322b21bff5">{"x":{"visdat":{"3645489386ca":["function () ","plotlyVisDat"]},"cur_data":"3645489386ca","attrs":{"3645489386ca":{"x":{},"y":{},"mode":"lines+markers","name":"KL divergence","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3645489386ca.1":{"x":{},"y":{},"mode":"lines+markers","name":"Fitted representativeness","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","yaxis":"y2","inherit":true},"3645489386ca.2":{"x":{},"y":{},"mode":"markers","name":"Optimal N","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","yaxis":"y2","marker":{"size":8,"color":"#d62728","line":{"color":"black","width":1}},"inherit":true}},"layout":{"margin":{"b":50,"l":80,"t":50,"r":100},"xaxis":{"domain":[0,1],"automargin":true,"title":"N","showgrid":true,"dtick":50,"tickfont":{"size":11}},"yaxis":{"domain":[0,1],"automargin":true,"title":"mean KL divergence","showgrid":false},"yaxis2":{"title":"Representativeness (%)","overlaying":"y","side":"right"},"legend":{"orientation":"h","y":1.2,"x":0.1,"traceorder":"normal"},"hovermode":"x","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false,"displayModeBar":false},"data":[{"x":[10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260,270,280,290,300],"y":[0.946656518285362,0.689693323936248,0.505473612411489,0.373404495664137,0.278722708063566,0.210844303755094,0.16218153673065,0.127294669271102,0.1022838941845,0.0843533972386822,0.0714988287732603,0.062283248695835,0.0556764990105469,0.0509400482350848,0.047544435109567,0.045110083092668,0.043364869629554,0.0421137070981325,0.0412167350582538,0.0405736860377481,0.0401126771942291,0.039782174935419,0.0395452342679802,0.0393753689239779,0.0392535906095798,0.039166286410217,0.0391036970792341,0.0390588261064577,0.0390266576175749,0.0390035956776842],"mode":"lines+markers","name":"KL divergence","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300],"y":[0,0.0327342353315526,0.0643969915994514,0.0950233411789092,0.124647208432504,0.153301407287702,0.18101767758437,0.207826720232533,0.233758231219328,0.258840934502818,0.283102613829098,0.306570143507957,0.32926951818115,0.351225881616292,0.372463554558241,0.393006061668836,0.412876157584819,0.432095852122823,0.450686434659318,0.468668497712549,0.486061959752569,0.502886087264639,0.519159516090429,0.534900272070678,0.550125791012148,0.564852938001018,0.579098026084094,0.592876834338535,0.606204625350105,0.619096162119319,0.631565724414206,0.643627124587798,0.655293722877873,0.666578442205901,0.677493782491567,0.68805183449876,0.698264293228331,0.708142470872478,0.717697309345096,0.726939392401975,0.735878957364275,0.744525906458257,0.752889817783834,0.760979955924095,0.768805282207548,0.776374464634452,0.783695887478239,0.790777660572649,0.797627628294874,0.804253378254664,0.810662249699009,0.816861341641719,0.822857520726896,0.828657428835018,0.834267490440052,0.83969391972575,0.844942727469013,0.850019727697939,0.854930544131937,0.859680616411041,0.864275206121318,0.868719402623056,0.873018128688164,0.877176145953068,0.881198060193094,0.885088326424229,0.888851253837869,0.892491010574054,0.896011628338453,0.899417006868225,0.902710918251706,0.905897011106689,0.908978814621952,0.911959742466485,0.914843096570764,0.917632070784247,0.920329754413163,0.922939135642482,0.925463104845889,0.927904457787412,0.930265898718242,0.932550043372199,0.934759421863137,0.93689648148752,0.938963589435253,0.940963035411785,0.942897034174381,0.944767727985379,0.946577188985141,0.948327421487336,0.950020364199082,0.951657892368431,0.953241819861552,0.954773901171921,0.956255833363753,0.957689257951811,0.959075762719691,0.960416883478584,0.961714105768477,0.962968866503656,0.964182555564363,0.965356517336341,0.966492052199993,0.967590417970793,0.968652831292554,0.969680468985078,0.970674469347711,0.971635933420218,0.972565926202386,0.973465477833711,0.97433558473447,0.975177210709438,0.975991288015482,0.97677871839421,0.977540374070816,0.978277098720228,0.978989708401641,0.979678992462447,0.980345714412589,0.980990612770286,0.981614401880082,0.982217772704114,0.982801393587479,0.983365910998553,0.983911950245072,0.984440116166778,0.984950993805391,0.985445149052651,0.985923129277147,0.986385463930632,0.986832665134486,0.987265228246986,0.987683632412009,0.988088341089772,0.988479802570198,0.988858450469483,0.989224704210406,0.989578969486914,0.98992163871351,0.990253091459919,0.990573694871532,0.990883804076093,0.991183762577063,0.991473902634116,0.991754545631179,0.992026002432425,0.992288573726608,0.992542550360137,0.99278821365924,0.993025835741586,0.993255679817703,0.993478000482536,0.993693043997457,0.993901048563042,0.994102244582929,0.994296854919026,0.994485095138376,0.994667173751935,0.994843292445539,0.995013646303306,0.995178424023731,0.995337808128701,0.995491975165674,0.995641095903238,0.995785335520267,0.995924853788891,0.996059805251468,0.996190339391774,0.99631660080058,0.996438729335814,0.996556860277482,0.996671124477511,0.996781648504696,0.996888554784897,0.996991961736647,0.997091983902324,0.99718873207503,0.997282313421309,0.997372831599859,0.997460386876352,0.997545076234497,0.997626993483464,0.997706229361802,0.99778287163794,0.997857005207416,0.997928712186907,0.997998072005194,0.998065161491138,0.99813005495879,0.998192824289702,0.998253539012548,0.998312266380146,0.998369071443947,0.998424017126097,0.998477164289128,0.998528571803382,0.998578296612215,0.998626393795076,0.998672916628515,0.9987179166452,0.998761443690995,0.998803545980176,0.998844270148839,0.998883661306552,0.998921763086329,0.998958617692959,0.998994265949753,0.999028747343768,0.999062100069544,0.999094361071409,0.999125566084408,0.99915574967388,0.999184945273748,0.999213185223555,0.999240500804282,0.999266922273002,0.999292478896392,0.999317198983152,0.999341109915363,0.999364238178818,0.999386609392358,0.999408248336252,0.999429178979643,0.999449424507101,0.999469007344302,0.999487949182872,0.999506271004408,0.999523993103728,0.999541135111343,0.999557716015206,0.999573754181743,0.999589267376198,0.999604272782312,0.999618787021355,0.999632826170538,0.999646405780823,0.999659540894148,0.999672246060087,0.999684535351967,0.999696422382458,0.999707920318652,0.999719041896646,0.999729799435649,0.999740204851632,0.999750269670522,0.999760005040974,0.999769421746715,0.999778530218495,0.999787340545634,0.999795862487204,0.999804105482837,0.999812078663178,0.999819790860004,0.999827250616004,0.999834466194239,0.999841445587303,0.999848196526166,0.999854726488747,0.999861042708189,0.999867152180877,0.999873061674186,0.999878777733974,0.99988430669184,0.999889654672128,0.99989482759872,0.99989983120159,0.999904671023157,0.999909352424421,0.999913880590902,0.999918260538385,0.999922497118473,0.999926595023965,0.999930558794051,0.999934392819342,0.999938101346731,0.999941688484102,0.999945158204873,0.999948514352405,0.999951760644252,0.999954900676286,0.999957937926674,0.999960875759734,0.999963717429661,0.999966466084132,0.999969124767792,0.999971696425625,0.99997418390622,0.999976589964923,0.99997891726689,0.99998116839004,0.999983345827908,0.999985451992413,0.99998748921652,0.999989459756835,0.999991365796095,0.999993209445592,0.999994992747511,0.99999671767719,0.999998386145307,1],"mode":"lines+markers","name":"Fitted representativeness","type":"scatter","yaxis":"y2","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","frame":null},{"x":[91],"y":[0.950020364199082],"mode":"markers","name":"Optimal N","type":"scatter","yaxis":"y2","marker":{"color":"#d62728","size":8,"line":{"color":"black","width":1}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p class="caption">
Figure 3.3: KL Divergence and Proportion of Representativeness as function of sample size
</p>
</div>
<p>According to Figure <a href="determining-the-optimal-sample-size.html#fig:fig-8">3.3</a>, the optimal sampling size for the area, that captures at least 95% of the environmental variability of covariates is 91.</p>
<p>Finally, in Figure <a href="determining-the-optimal-sample-size.html#fig:fig-9">3.4</a> we represent the optimal distribution of samples over the study area according to these specific results, and taking into account the optimal sampling size and the increasing interval in the sample size.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="determining-the-optimal-sample-size.html#cb18-1" aria-hidden="true" tabindex="-1"></a>optimal_iteration <span class="ot">&lt;-</span> results <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="determining-the-optimal-sample-size.html#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(N<span class="sc">==</span><span class="fu">ceiling</span>(optimal_n<span class="sc">/</span>by.n)<span class="sc">*</span>by.n) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="determining-the-optimal-sample-size.html#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">IDX =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="determining-the-optimal-sample-size.html#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Perc<span class="sc">==</span><span class="fu">max</span>(Perc))</span>
<span id="cb18-5"><a href="determining-the-optimal-sample-size.html#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="determining-the-optimal-sample-size.html#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cov.dat[[<span class="dv">1</span>]])</span>
<span id="cb18-7"><a href="determining-the-optimal-sample-size.html#cb18-7" aria-hidden="true" tabindex="-1"></a>N_final <span class="ot">&lt;-</span> samples_storage[<span class="fu">paste0</span>(<span class="st">&quot;N&quot;</span>,<span class="fu">ceiling</span>(optimal_n<span class="sc">/</span>by.n)<span class="sc">*</span>by.n,<span class="st">&quot;_&quot;</span>, optimal_iteration<span class="sc">$</span>IDX)][[<span class="dv">1</span>]]</span>
<span id="cb18-8"><a href="determining-the-optimal-sample-size.html#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(N_final)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:fig-9"></span>
<img src="Technical-Manual-Soil-Sampling-Design_files/figure-html/fig-9-1.png" alt="Covariates and optimal number and distribution of samples" width="672" />
<p class="caption">
Figure 3.4: Covariates and optimal number and distribution of samples
</p>
</div>
<p>In summary, we utilize the variability within the covariate data to ascertain the minimum number of samples required to capture a minimum of 95% of this variability. Our approach involves assessing the similarities in variability between the sample space and the population space (study area) through calculations of the Kullback-Leibler (KL) divergence and the percentage of representativeness at various stages of increasing sample sizes. These results are then utilized to fit a model representing the expected distribution of representativeness as a function of sample size. This model guides us in determining the minimum sample size necessary to achieve a representation of at least 95% of the environmental diversity within the area</p>

</div>
<!-- </div> -->
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-Malone" class="csl-entry">
<strong>Malone, B.P., Minansy, B. &amp; Brungard, C.</strong> 2019. Some methods to improve the utility of conditioned latin hypercube sampling. <em>PeerJ</em>, 7: e6451. <a href="https://doi.org/10.7717/peerj.6451">https://doi.org/10.7717/peerj.6451</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="creating-a-sampling-design.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stratified-sampling-design.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

</body>

</html>
